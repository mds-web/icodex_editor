<!DOCTYPE html>
<html translate="no" data-theme="dark" lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Icodex</title>

    <link rel="stylesheet" href="src/icon/tabler-icons.css" />
    <link
      rel="stylesheet"
      href="./src/icon/devicon.min.css"
      type="text/css"
      media="all"
    />
    <link
      rel="stylesheet"
      href="src/icon/bootstrap-icons.min.css"
      type="text/css"
      media="all"
    />
<meta name="theme-color" content="#23293c">
    <link
      rel="stylesheet"
      href="src/icon/icodex-ui/css/icodex-ui-fonts.css"
      type="text/css"
      media="all"
    />
    <link
      rel="stylesheet"
      href="bundle-icon-ui.css"
      type="text/css"
      media="all"
    />
    <link rel="stylesheet" href="app.css" type="text/css" media="all" />
    <style>
      .ace_indent-guide-active {
      }

      .ace_content {
        border-right: none !important; /* ini garis tengahnya */
      }

      .ace_print-margin {
        display: none !important;
      }

      .ace_indent-guide {
        background: none !important;
        display: inline-block;
        border-right: 1px solid var(--border-color); /* bisa kamu ganti warnanya */
      }
    </style>
    <link rel="stylesheet" href="github-dark.css" type="text/css" media="all" />
    <link rel="stylesheet" href="ace-autocomplite.css" type="text/css" media="all" />
  </head>
  <body>
    <!-- <div class="navbar" style="display: none"> -->
    <!-- <div class="container"> -->
    <!-- <span -->
    <!-- role="button" -->
    <!-- type="button" -->
    <!-- aria-label="sidebar-open" -->
    <!-- class="toggler-menu btn" -->
    <!-- > -->
    <!-- <i class="bi bi-list"></i> -->
    <!-- </span> -->
    <!-- <span class="page-title">Settings</span> -->
    <!-- </div> -->
    <!-- </div> -->
    <div id="mainWrapper" class="main">
      <div class="file_explorer-drawer" id="drawer">
        <div class="drawer-header">
          <div class="drawer-tab">
            <button class="btn" aria-label="toolbar-buttons">
              <i class="icodex icodex-paper-airplane"></i>
            </button>
            <button class="btn" aria-label="toolbar-buttons">
              <i class="icodex icodex-file-directory"></i>
            </button>
            <button class="btn" aria-label="toolbar-buttons">
              <i class="icodex icodex-codescan"></i>
            </button>
            <button class="btn" aria-label="toolbar-buttons">
              <i class="icodex icodex-git-branch"></i>
            </button>
            <button class="btn" aria-label="toolbar-buttons">
              <i class="icodex icodex-person"></i>
            </button>
          </div>
        </div>
        <div class="drawer-body">
          <div id="treeview" class="treeView">
            <div class="treeView-header">
              <span class="_title"> Files </span>
              <button aria-label="search code" class="btn">
                <i class="icodex icodex-search"></i>
              </button>

              <button aria-label="search code" class="btn">
                <i class="icodex icodex-location"></i>
              </button>

              <button aria-label="search code" class="btn">
                <i class="icodex icodex-file-added"></i>
              </button>

              <button aria-label="search code" class="btn">
                <i class="icodex icodex-folder-plus"></i>
              </button>

              <button aria-label="search code" class="btn">
                <i class="icodex icodex-kebab-horizontal"></i>
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="drawer-backdrop" id="backdrop1"></div>
      <div class="content-right">
        <div class="navbar">
          <div class="container">
            <span
              role="button"
              type="button"
              aria-label="sidebar-open"
              class="toggler-menu btn"
              id="open-drawer"
            >
              <i class="bi bi-list"></i>
            </span>
            <div class="pagination-tab d-[none] md:d-[flex]">
              <span aria-label="btn" role="button" class="btn">
                <i class="icodex icodex-arrow-left"></i>
              </span>
              <span aria-label="btn" role="button" class="btn">
                <i class="icodex icodex-arrow-right"></i>
              </span>
            </div>
            <ul class="breadcrumb" id="breadcrumb"></ul>

            <div class="toolbar-buttons">
              <span aria-label="btn" role="button" class="btn">
                <i class="icodex icodex-search-2"></i>
              </span>
              <span aria-label="btn" role="button" class="btn">
                <i class="tb tb-player-play-filled"></i>
              </span>
              <span
                aria-label="btn"
                role="button"
                class="btn d-[none] md:d-[inline-flex]"
              >
                <i class="icodex icodex-sidebar-expand"></i>
              </span>
            </div>
          </div>
        </div>

        <div class="container px-0">
          <nav class="file-tab_container">
            <ul class="file-tab_content">
              <li class="file-tab_items">
                <a class="file-tab_link">
                  <i class="devicon devicon-html5-plain colored"></i>
                  <span class="file_name">app.html</span>
                </a>
              </li>

              <li class="file-tab_items">
                <a class="file-tab_link">
                  <i class="devicon devicon-css3-plain colored"></i>
                  <span class="file_name">style.css</span>
                </a>
              </li>

              <li class="file-tab_items">
                <a class="file-tab_link">
                  <i class="devicon devicon-javascript-plain colored"></i>
                  <span class="file_name">main.js</span>
                </a>
              </li>
              <li class="file-tab_items">
                <a class="file-tab_link">
                  <i class="devicon devicon-javascript-plain colored"></i>
                  <span class="file_name">main.js</span>
                </a>
              </li>
              <li class="file-tab_items">
                <a class="file-tab_link">
                  <i class="devicon devicon-javascript-plain colored"></i>
                  <span class="file_name">main.js</span>
                </a>
              </li>
              <li class="file-tab_items">
                <a class="file-tab_link">
                  <i class="devicon devicon-javascript-plain colored"></i>
                  <span class="file_name">main.js</span>
                </a>
              </li>
            </ul>
          </nav>
          <div class="main-app">
            <div class="content-left">
              <div class="editor">
                <div id="editor"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="bg-dark"></div>
    <script type="text/javascript" src="assets/ace/ace.js"></script>
    <script
      type="text/javascript"
      src="assets/ace/ext-language_tools.js"
    ></script>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const editor = ace.edit('editor');
        editor.setTheme('ace/theme/github');
        editor.session.setMode('ace/mode/html');
        editor.session.setUseWorker(true);
        editor.setOptions({
          enableBasicAutocompletion: true,
          enableLiveAutocompletion: true,
          enableSnippets: true,
          wrap: true,
          animatedScroll: false,
          scrollSpeed: 0,
        });

        const defaultHTML = `<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    /* CSS Default */
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 20px;
    }

    h1 {
      color: #333;
    }
  <\/style>
<\/head>
<body>
  <h1>Hello World<\/h1>
  <p>This is a default HTML template with embedded CSS and JavaScript.<\/p>

  <script>
    // JavaScript Default
    document.addEventListener('DOMContentLoaded', function () {
      console.log('Page loaded');
    });
  <\/script>
<\/body>
<\/html>`;
        editor.session.setValue(defaultHTML, -1); // -1 agar cursor di awal
        editor.session.setTabSize(2);
        editor.session.setUseSoftTabs(true);
        // editor.setValue("select your code here", -1); // -1 agar cursor di awal
        const size = 14;
        const lineHeight = size * 1.5;

        editor.setOption('scrollPastEnd', 0.75);
        editor.setFontSize(size);
        editor.renderer.lineHeight = lineHeight;
        editor.renderer.updateFontSize();

        document.getElementById('editor').addEventListener(
          'wheel',
          function (e) {
            e.preventDefault(); // cegah scroll default
            editor.renderer.scrollBy(0, e.deltaY);
          },
          { passive: false },
        );

        const backdrop = document.getElementById('backdrop1');
        const toggler = document.getElementById('open-drawer');
        const drawer = document.getElementById('drawer');
        const mainWrapper = document.getElementById('mainWrapper');

        function isMobilePlatform() {
          const ua = navigator.userAgent || navigator.vendor || window.opera;
          return /android/i.test(ua) || /iPhone|iPad|iPod/i.test(ua);
        }

        // backdrop hanya muncul di mobile
        toggler.addEventListener('click', function () {
          drawer.classList.toggle('open');
          mainWrapper.classList.toggle('open');
          if (drawer.classList.contains('open') && isMobilePlatform()) {
            backdrop.style.display = 'block';
          } else {
            backdrop.style.display = 'none';
          }
        });

        backdrop.addEventListener('click', function () {
          backdrop.style.display = 'none';
          drawer.classList.remove('open');
          mainWrapper.classList.remove('open');
        });

        function getPlatform() {
          const ua = navigator.userAgent || navigator.vendor || window.opera;
          const platform = navigator.platform.toLowerCase();

          if (/android/i.test(ua)) {
            return 'Android';
          }

          if (/iPhone|iPad|iPod/i.test(ua)) {
            return 'iOS';
          }

          if (platform.includes('mac')) {
            return 'macOS';
          }

          if (platform.includes('win')) {
            return 'Windows';
          }

          if (/linux/.test(platform)) {
            return 'Linux';
          }

          return 'Unknown';
        }

        // Penggunaan:
        const devicePlatform = getPlatform();
        console.log('Platform:', devicePlatform);

        document.addEventListener('keydown', e => {
          // const backdrop = document.getElementById("backdrop1");

          if (e.ctrlKey && e.key === 'b'.toLowerCase()) {
            drawer.classList.toggle('open');
            mainWrapper.classList.toggle('open');

            if (drawer.classList.contains('open')) {
              // tampilkan backdrop

              if (devicePlatform === 'Android' || devicePlatform === 'iOS') {
                backdrop.style.display = 'block'; // tampilkan backdrop di mobile
              } else {
                backdrop.style.display = 'none'; // sembunyikan backdrop di desktop
              }
            } else {
              // sembunyikan backdrop
              backdrop.style.display = 'none';
            }
          }
        });
      });
    </script>

    <script>
      const path = 'assets/ace/ace.js'; // contoh: ganti ini untuk test
      const parts = path.replace(/^\/+/, '').split('/');

      // Pemetaan ekstensi ke class icon khusus
      const iconMap = {
        css: 'devicon-css3-plain colored',
        js: 'devicon-javascript-plain colored',
        html: 'devicon-html5-plain colored',
        json: 'icon-json',
        txt: 'icon-txt',
        md: 'icon-markdown',
        default: '',
      };

      let cumulative = '';
      const links = [];

      parts.forEach((part, index) => {
        cumulative += '/' + part;

        const list = document.createElement('li');
        list.className = 'breadcrumb-item';
        list.dataset.index = index;

        const a = document.createElement('a');

        const isLast = index === parts.length - 1;
        const isSingle = parts.length === 1;

        if (isLast) {
          // bagian akhir (file)
          a.classList.add('last');

          const ext = part.includes('.') ? part.split('.').pop() : '';
          const iconClass = iconMap[ext] || iconMap.default;

          const icon = document.createElement('i');
          icon.className = ` ${iconClass}`;

          const span = document.createElement('span');
          span.textContent = part;

          a.appendChild(icon);
          a.appendChild(span);
        } else {
          // bagian folder
          a.textContent = part;

          // tambahkan ikon chevron jika bukan satu-satunya elemen
          if (!isSingle) {
            const chevron = document.createElement('i');
            chevron.className = 'icodex icodex-chevron-right';
            a.appendChild(chevron);
          }
        }

        list.appendChild(a);
        links.push(list);
      });

      // Sisipkan ke dalam container
      const container = document.getElementById('breadcrumb');

      document.addEventListener('DOMContentLoaded', e => {
        links.forEach(link => container.appendChild(link));
      });
      console.info();
    </script>
  </body>
</html>
    </script>
  </body>
</html>
